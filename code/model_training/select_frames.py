import os
import shutil
from pathlib import Path

# Ruta del dataset original
source_path = '/home/enrique/Desktop/VARIOS/garzIA/pebble_contours/data/datasets/pebbles_final_dataset'

# Ruta del nuevo dataset filtrado
target_path = '/home/enrique/Desktop/VARIOS/garzIA/pebble_contours/data/datasets/pebbles_final_filtered'

# Lista de imágenes que quieres incluir (solo los nombres de archivo)
selected_images = [
    'Pebbles (1).jpg',
    'Pebbles (1010).jpg',
    'Pebbles (1035).jpg',
    'Pebbles (1042).jpg',
    'Pebbles (1045).jpg',
    'Pebbles (105).jpg',
    'Pebbles (1054).jpg',
    'Pebbles (106).jpg',
    'Pebbles (1061).jpg',
    'Pebbles (107).jpg',
    'Pebbles (1073).jpg',
    'Pebbles (1076).jpg',
    'Pebbles (1077).jpg',
    'Pebbles (108).jpg',
    'Pebbles (1080).jpg',
    'Pebbles (1081).jpg',
    'Pebbles (1084).jpg',
    'Pebbles (1086).jpg',
    'Pebbles (109).jpg',
    'Pebbles (1094).jpg',
    'Pebbles (1095).jpg',
    'Pebbles (110).jpg',
    'Pebbles (1106).jpg',
    'Pebbles (111).jpg',
    'Pebbles (112).jpg',
    'Pebbles (1120).jpg',
    'Pebbles (1130).jpg',
    'Pebbles (1132).jpg',
    'Pebbles (1134).jpg',
    'Pebbles (1138).jpg',
    'Pebbles (1142).jpg',
    'Pebbles (1145).jpg',
    'Pebbles (1153).jpg',
    'Pebbles (117).jpg',
    'Pebbles (1171).jpg',
    'Pebbles (1172).jpg',
    'Pebbles (1203).jpg',
    'Pebbles (1205).jpg',
    'Pebbles (1209).jpg',
    'Pebbles (1213).jpg',
    'Pebbles (1225).jpg',
    'Pebbles (1232).jpg',
    'Pebbles (1234).jpg',
    'Pebbles (1236).jpg',
    'Pebbles (1248).jpg',
    'Pebbles (1250).jpg',
    'Pebbles (1261).jpg',
    'Pebbles (1263).jpg',
    'Pebbles (1269).jpg',
    'Pebbles (1272).jpg',
    'Pebbles (1276).jpg',
    'Pebbles (1277).jpg',
    'Pebbles (1278).jpg',
    'Pebbles (1279).jpg',
    'Pebbles (1280).jpg',
    'Pebbles (1281).jpg',
    'Pebbles (1282).jpg',
    'Pebbles (1286).jpg',
    'Pebbles (1289).jpg',
    'Pebbles (1290).jpg',
    'Pebbles (1291).jpg',
    'Pebbles (1295).jpg',
    'Pebbles (1297).jpg',
    'Pebbles (1298).jpg',
    'Pebbles (1307).jpg',
    'Pebbles (1309).jpg',
    'Pebbles (1311).jpg',
    'Pebbles (1312).jpg',
    'Pebbles (1314).jpg',
    'Pebbles (1315).jpg',
    'Pebbles (1318).jpg',
    'Pebbles (1320).jpg',
    'Pebbles (1326).jpg',
    'Pebbles (1327).jpg',
    'Pebbles (1334).jpg',
    'Pebbles (1345).jpg',
    'Pebbles (1349).jpg',
    'Pebbles (135).jpg',
    'Pebbles (1350).jpg',
    'Pebbles (1351).jpg',
    'Pebbles (1353).jpg',
    'Pebbles (1355).jpg',
    'Pebbles (1359).jpg',
    'Pebbles (1360).jpg',
    'Pebbles (1363).jpg',
    'Pebbles (1364).jpg',
    'Pebbles (1378).jpg',
    'Pebbles (1380).jpg',
    'Pebbles (1385).jpg',
    'Pebbles (1388).jpg',
    'Pebbles (1398).jpg',
    'Pebbles (1407).jpg',
    'Pebbles (1409).jpg',
    'Pebbles (1410).jpg',
    'Pebbles (1412).jpg',
    'Pebbles (1415).jpg',
    'Pebbles (1416).jpg',
    'Pebbles (1417).jpg',
    'Pebbles (1423).jpg',
    'Pebbles (1425).jpg',
    'Pebbles (1426).jpg',
    'Pebbles (1430).jpg',
    'Pebbles (1433).jpg',
    'Pebbles (1437).jpg',
    'Pebbles (1439).jpg',
    'Pebbles (1441).jpg',
    'Pebbles (1445).jpg',
    'Pebbles (1448).jpg',
    'Pebbles (1455).jpg',
    'Pebbles (1456).jpg',
    'Pebbles (1458).jpg',
    'Pebbles (1463).jpg',
    'Pebbles (1467).jpg',
    'Pebbles (1468).jpg',
    'Pebbles (1471).jpg',
    'Pebbles (1475).jpg',
    'Pebbles (1477).jpg',
    'Pebbles (148).jpg',
    'Pebbles (1501).jpg',
    'Pebbles (1508).jpg',
    'Pebbles (1509).jpg',
    'Pebbles (1512).jpg',
    'Pebbles (1539).jpg',
    'Pebbles (154).jpg',
    'Pebbles (1541).jpg',
    'Pebbles (1587).jpg',
    'Pebbles (1597).jpg',
    'Pebbles (1603).jpg',
    'Pebbles (1612).jpg',
    'Pebbles (1616).jpg',
    'Pebbles (1621).jpg',
    'Pebbles (1622).jpg',
    'Pebbles (1624).jpg',
    'Pebbles (1627).jpg',
    'Pebbles (1638).jpg',
    'Pebbles (1645).jpg',
    'Pebbles (1648).jpg',
    'Pebbles (1665).jpg',
    'Pebbles (1670).jpg',
    'Pebbles (1671).jpg',
    'Pebbles (1684).jpg',
    'Pebbles (1700).jpg',
    'Pebbles (1711).jpg',
    'Pebbles (1718).jpg',
    'Pebbles (1745).jpg',
    'Pebbles (1766).jpg',
    'Pebbles (1768).jpg',
    'Pebbles (1822).jpg',
    'Pebbles (1838).jpg',
    'Pebbles (1848).jpg',
    'Pebbles (185).jpg',
    'Pebbles (187).jpg',
    'Pebbles (189).jpg',
    'Pebbles (1909).jpg',
    'Pebbles (192).jpg',
    'Pebbles (193).jpg',
    'Pebbles (195).jpg',
    'Pebbles (1970).jpg',
    'Pebbles (1972).jpg',
    'Pebbles (1990).jpg',
    'Pebbles (1994).jpg',
    'Pebbles (1995).jpg',
    'Pebbles (1999).jpg',
    'Pebbles (200).jpg',
    'Pebbles (2006).jpg',
    'Pebbles (2007).jpg',
    'Pebbles (2009).jpg',
    'Pebbles (2015).jpg',
    'Pebbles (2022).jpg',
    'Pebbles (2028).jpg',
    'Pebbles (2036).jpg',
    'Pebbles (2038).jpg',
    'Pebbles (2041).jpg',
    'Pebbles (2044).jpg',
    'Pebbles (2048).jpg',
    'Pebbles (2050).jpg',
    'Pebbles (2059).jpg',
    'Pebbles (2064).jpg',
    'Pebbles (2081).jpg',
    'Pebbles (2082).jpg',
    'Pebbles (2084).jpg',
    'Pebbles (2094).jpg',
    'Pebbles (2096).jpg',
    'Pebbles (2098).jpg',
    'Pebbles (2110).jpg',
    'Pebbles (2111).jpg',
    'Pebbles (2115).jpg',
    'Pebbles (212).jpg',
    'Pebbles (2122).jpg',
    'Pebbles (2124).jpg',
    'Pebbles (2126).jpg',
    'Pebbles (2129).jpg',
    'Pebbles (2131).jpg',
    'Pebbles (2132).jpg',
    'Pebbles (2133).jpg',
    'Pebbles (2136).jpg',
    'Pebbles (2140).jpg',
    'Pebbles (2141).jpg',
    'Pebbles (2142).jpg',
    'Pebbles (2143).jpg',
    'Pebbles (2144).jpg',
    'Pebbles (2146).jpg',
    'Pebbles (2159).jpg',
    'Pebbles (2166).jpg',
    'Pebbles (2175).jpg',
    'Pebbles (2177).jpg',
    'Pebbles (2178).jpg',
    'Pebbles (2181).jpg',
    'Pebbles (2189).jpg',
    'Pebbles (219).jpg',
    'Pebbles (2200).jpg',
    'Pebbles (2205).jpg',
    'Pebbles (2208).jpg',
    'Pebbles (2210).jpg',
    'Pebbles (2212).jpg',
    'Pebbles (2224).jpg',
    'Pebbles (2225).jpg',
    'Pebbles (2226).jpg',
    'Pebbles (2229).jpg',
    'Pebbles (2236).jpg',
    'Pebbles (2237).jpg',
    'Pebbles (2240).jpg',
    'Pebbles (2246).jpg',
    'Pebbles (225).jpg',
    'Pebbles (2254).jpg',
    'Pebbles (2274).jpg',
    'Pebbles (2276).jpg',
    'Pebbles (228).jpg',
    'Pebbles (2281).jpg',
    'Pebbles (2283).jpg',
    'Pebbles (229).jpg',
    'Pebbles (2292).jpg',
    'Pebbles (2306).jpg',
    'Pebbles (2307).jpg',
    'Pebbles (2309).jpg',
    'Pebbles (2310).jpg',
    'Pebbles (2311).jpg',
    'Pebbles (2326).jpg',
    'Pebbles (2340).jpg',
    'Pebbles (2341).jpg',
    'Pebbles (2349).jpg',
    'Pebbles (2351).jpg',
    'Pebbles (2354).jpg',
    'Pebbles (2367).jpg',
    'Pebbles (2369).jpg',
    'Pebbles (2374).jpg',
    'Pebbles (2375).jpg',
    'Pebbles (238).jpg',
    'Pebbles (2383).jpg',
    'Pebbles (2384).jpg',
    'Pebbles (2391).jpg',
    'Pebbles (2397).jpg',
    'Pebbles (2399).jpg',
    'Pebbles (2406).jpg',
    'Pebbles (2409).jpg',
    'Pebbles (2413).jpg',
    'Pebbles (2414).jpg',
    'Pebbles (2420).jpg',
    'Pebbles (2421).jpg',
    'Pebbles (2425).jpg',
    'Pebbles (2432).jpg',
    'Pebbles (2436).jpg',
    'Pebbles (2439).jpg',
    'Pebbles (2442).jpg',
    'Pebbles (2444).jpg',
    'Pebbles (2449).jpg',
    'Pebbles (245).jpg',
    'Pebbles (2453).jpg',
    'Pebbles (2454).jpg',
    'Pebbles (2459).jpg',
    'Pebbles (2461).jpg',
    'Pebbles (2462).jpg',
    'Pebbles (2464).jpg',
    'Pebbles (2469).jpg',
    'Pebbles (2481).jpg',
    'Pebbles (2521).jpg',
    'Pebbles (2523).jpg',
    'Pebbles (2524).jpg',
    'Pebbles (2528).jpg',
    'Pebbles (2538).jpg',
    'Pebbles (2543).jpg',
    'Pebbles (2545).jpg',
    'Pebbles (2547).jpg',
    'Pebbles (2548).jpg',
    'Pebbles (2553).jpg',
    'Pebbles (2556).jpg',
    'Pebbles (2557).jpg',
    'Pebbles (2558).jpg',
    'Pebbles (2564).jpg',
    'Pebbles (2567).jpg',
    'Pebbles (2568).jpg',
    'Pebbles (2607).jpg',
    'Pebbles (2733).jpg',
    'Pebbles (299).jpg',
    'Pebbles (30).jpg',
    'Pebbles (302).jpg',
    'Pebbles (315).jpg',
    'Pebbles (316).jpg',
    'Pebbles (320).jpg',
    'Pebbles (324).jpg',
    'Pebbles (348).jpg',
    'Pebbles (349).jpg',
    'Pebbles (351).jpg',
    'Pebbles (37).jpg',
    'Pebbles (380).jpg',
    'Pebbles (381).jpg',
    'Pebbles (383).jpg',
    'Pebbles (410).jpg',
    'Pebbles (411).jpg',
    'Pebbles (416).jpg',
    'Pebbles (417).jpg',
    'Pebbles (418).jpg',
    'Pebbles (419).jpg',
    'Pebbles (421).jpg',
    'Pebbles (437).jpg',
    'Pebbles (471).jpg',
    'Pebbles (473).jpg',
    'Pebbles (475).jpg',
    'Pebbles (476).jpg',
    'Pebbles (477).jpg',
    'Pebbles (49).jpg',
    'Pebbles (50).jpg',
    'Pebbles (504).jpg',
    'Pebbles (505).jpg',
    'Pebbles (506).jpg',
    'Pebbles (507).jpg',
    'Pebbles (508).jpg',
    'Pebbles (509).jpg',
    'Pebbles (52).jpg',
    'Pebbles (531).jpg',
    'Pebbles (538).jpg',
    'Pebbles (539).jpg',
    'Pebbles (540).jpg',
    'Pebbles (55).jpg',
    'Pebbles (559).jpg',
    'Pebbles (56).jpg',
    'Pebbles (568).jpg',
    'Pebbles (584).jpg',
    'Pebbles (586).jpg',
    'Pebbles (60).jpg',
    'Pebbles (604).jpg',
    'Pebbles (611).jpg',
    'Pebbles (618).jpg',
    'Pebbles (632).jpg',
    'Pebbles (639).jpg',
    'Pebbles (640).jpg',
    'Pebbles (643).jpg',
    'Pebbles (647).jpg',
    'Pebbles (668).jpg',
    'Pebbles (67).jpg',
    'Pebbles (671).jpg',
    'Pebbles (672).jpg',
    'Pebbles (676).jpg',
    'Pebbles (681).jpg',
    'Pebbles (682).jpg',
    'Pebbles (690).jpg',
    'Pebbles (695).jpg',
    'Pebbles (699).jpg',
    'Pebbles (703).jpg',
    'Pebbles (721).jpg',
    'Pebbles (724).jpg',
    'Pebbles (725).jpg',
    'Pebbles (761).jpg',
    'Pebbles (763).jpg',
    'Pebbles (771).jpg',
    'Pebbles (772).jpg',
    'Pebbles (776).jpg',
    'Pebbles (778).jpg',
    'Pebbles (780).jpg',
    'Pebbles (781).jpg',
    'Pebbles (782).jpg',
    'Pebbles (783).jpg',
    'Pebbles (785).jpg',
    'Pebbles (793).jpg',
    'Pebbles (795).jpg',
    'Pebbles (796).jpg',
    'Pebbles (799).jpg',
    'Pebbles (860).jpg',
    'Pebbles (872).jpg',
    'Pebbles (877).jpg',
    'Pebbles (888).jpg',
    'Pebbles (898).jpg',
    'Pebbles (907).jpg',
    'Pebbles (918).jpg',
    'Pebbles (920).jpg',
    'Pebbles (93).jpg',
    'Pebbles (94).jpg',
    'Pebbles (95).jpg',
    'Pebbles (96).jpg',
    'Pebbles (97).jpg',
    'Pebbles (970).jpg',
    'Pebbles (971).jpg',
    'Pebbles (972).jpg',
    'Pebbles (973).jpg',
    'Pebbles (98).jpg',
    'Pebbles (99).jpg',
]



def copy_filtered_dataset():
    # Crear estructura de directorios del nuevo dataset
    target_images_train = Path(target_path) / 'images' / 'train'
    target_labels_train = Path(target_path) / 'labels' / 'train'
    
    target_images_train.mkdir(parents=True, exist_ok=True)
    target_labels_train.mkdir(parents=True, exist_ok=True)
    
    # Contadores para estadísticas
    copied_images = 0
    copied_labels = 0
    missing_images = []
    missing_labels = []
    
    print(f"Copiando dataset filtrado a: {target_path}")
    print(f"Total de imágenes a procesar: {len(selected_images)}")
    print("-" * 50)
    
    for image_name in selected_images:
        # Rutas de origen
        source_image = Path(source_path) / 'images' / 'train' / image_name
        source_label = Path(source_path) / 'labels' / 'train' / image_name.replace('.jpg', '.txt')
        
        # Rutas de destino
        target_image = target_images_train / image_name
        target_label = target_labels_train / image_name.replace('.jpg', '.txt')
        
        # Copiar imagen si existe
        if source_image.exists():
            shutil.copy2(source_image, target_image)
            copied_images += 1
            print(f"✓ Imagen copiada: {image_name}")
        else:
            missing_images.append(image_name)
            print(f"✗ Imagen no encontrada: {image_name}")
        
        # Copiar label si existe
        if source_label.exists():
            shutil.copy2(source_label, target_label)
            copied_labels += 1
        else:
            missing_labels.append(image_name.replace('.jpg', '.txt'))
    
    # Reporte final
    print("\n" + "=" * 50)
    print("REPORTE FINAL:")
    print(f"Imágenes copiadas: {copied_images}/{len(selected_images)}")
    print(f"Labels copiados: {copied_labels}/{len(selected_images)}")
    
    if missing_images:
        print(f"\nImágenes no encontradas ({len(missing_images)}):")
        for img in missing_images:
            print(f"  - {img}")
    
    if missing_labels:
        print(f"\nLabels no encontrados ({len(missing_labels)}):")
        for lbl in missing_labels:
            print(f"  - {lbl}")
    
    print(f"\nDataset filtrado creado en: {target_path}")

if __name__ == "__main__":
    copy_filtered_dataset()
